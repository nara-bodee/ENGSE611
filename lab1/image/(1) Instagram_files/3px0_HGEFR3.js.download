;/*FB_PKG_DELIM*/

__d("CPXComposerConstants",[],(function(t,n,r,o,a,i){"use strict";var e=120,l=68,s=90,u=160,c=10,d=4;i.THUMBNAIL_WIDTH=e,i.THUMBNAIL_HEIGHT=l,i.REEL_THUMBNAIL_WIDTH=s,i.REEL_THUMBNAIL_HEIGHT=u,i.NUM_OF_THUMBNAILS=c,i.MAX_NUM_THUMBNAILS=d}),66);
__d("CanvasToBlobImpl",["BlobFactory"],(function(t,n,r,o,a,i){function e(e,t){for(var r=atob(e.substr(e.indexOf(",")+1)),o=new Uint8Array(r.length),a=0;a<r.length;a++)o[a]=r.charCodeAt(a);return n("BlobFactory").getBlob([o],{type:t})}a.exports={getBlob:e}}),null);
__d("VideoThumbnail_UNTYPED",["invariant","vulture"],(function(t,n,r,o,a,i,l){var e=(function(){"use strict";function e(e){this.$1=e}var t=e.prototype;return t.getURL=function(){return this.$1},t.getData=function(){n("vulture")("a1B5XUEMmGR-xYeKTjqzsKYluSg="),l(0,4844)},e.addTextToCanvasContext=function(t,r,o,a,i,l,s,u,c){n("vulture")("qikNWy_gjGUk0GFVslGmB8bCVwk="),t.fillStyle=u,t.textAlign=c,t.font=l+"px "+s;var e=c==="center"?a+i/2:a,d=1,m=r.split("\n");for(var p of m){var _="",f="",g=p.split(" ");for(var h of g){f+=h;var y=t.measureText(f).width,C=t.measureText(h).width;if(C>i){_.length>0&&(t.fillText(_,e,o+l*d),d++);var b="",v="";for(var S of h){v+=S;var R=t.measureText(v).width;R>i?(t.fillText(b,e,o+l*d),b=S,v=S,d++):b=v}_=b+" ",f=b+" "}else y>i?(t.fillText(_,e,o+l*d),_=h+" ",f=h+" ",d++):(f+=" ",_=f)}t.fillText(_,e,o+l*d),d++}return t},e})();a.exports=e}),null);
__d("dataURLToBlob",["BlobFactory","CanvasToBlobImpl","CanvasToBlobResource","Promise","WebWorker"],(function(t,n,r,o,a,i,l){var e,s=t.URL||t.webkitURL||{};function u(t,a){return!s.createObjectURL||!r("BlobFactory").isSupported?(e||(e=n("Promise"))).reject("Browser doesn't support this feature"):r("WebWorker").isSupported()?new(e||(e=n("Promise")))(function(e,n){var o=new(r("WebWorker"))(r("CanvasToBlobResource")).setMessageHandler(function(t){e(t),o.terminate()}).setErrorHandler(function(e){n(e.message),o.terminate()}).execute().postMessage({dataURL:t,fileType:a})}):(e||(e=n("Promise"))).resolve(o("CanvasToBlobImpl").getBlob(t,a))}l.default=u}),98);
__d("canvasToBlob",["Promise","dataURLToBlob","promiseDone"],(function(t,n,r,o,a,i,l){var e;function s(t,o,a){return new(e||(e=n("Promise")))(function(e,n){if("toBlob"in t)t.toBlob(e,o,a);else{var i=t.toDataURL(o,a);r("promiseDone")(r("dataURLToBlob")(i,o).then(function(t){e(t)},n))}})}l.default=s}),98);
__d("CanvasVideoThumbnail",["EventListener","Promise","VideoThumbnail_UNTYPED","canvasToBlob","promiseDone"],(function(t,n,r,o,a,i,l){var e,s=(function(t){function o(e,n,r,o,a,i,l){var s;return o===void 0&&(o=null),a===void 0&&(a=null),i===void 0&&(i=0),l===void 0&&(l=0),s=t.call(this,null)||this,s.$CanvasVideoThumbnail$p_1=e,s.$CanvasVideoThumbnail$p_2=n,s.$CanvasVideoThumbnail$p_3=r,s.$CanvasVideoThumbnail$p_4=o,s.$CanvasVideoThumbnail$p_5=a,s.$CanvasVideoThumbnail$p_6=i,s.$CanvasVideoThumbnail$p_7=l,s.$CanvasVideoThumbnail$p_8=s.$CanvasVideoThumbnail$p_1.toDataURL("image/jpeg"),s}babelHelpers.inheritsLoose(o,t);var a=o.prototype;return a.getCanvas=function(){return this.$CanvasVideoThumbnail$p_1},a.getTime=function(){return this.$CanvasVideoThumbnail$p_3?this.$CanvasVideoThumbnail$p_3:0},a.getURL=function(){return this.$CanvasVideoThumbnail$p_8||(this.$CanvasVideoThumbnail$p_8=this.$CanvasVideoThumbnail$p_1.toDataURL("image/jpeg")),this.$CanvasVideoThumbnail$p_8},a.getData=function(){var t=this,o=document.createElement("canvas"),a=o.getContext("2d"),i=this.$CanvasVideoThumbnail$p_2;return new(e||(e=n("Promise")))(function(e,n){var l=r("EventListener").listen(i,"seeked",function(){l.remove(),t.$CanvasVideoThumbnail$p_9(o,a),r("promiseDone")(r("canvasToBlob")(o,"image/jpeg").then(e,n))});i.currentTime=t.$CanvasVideoThumbnail$p_3})},a.getDataWithText=function(o,a,i,l,s,u,c,d){var t=this,m=document.createElement("canvas"),p=m.getContext("2d"),_=this.$CanvasVideoThumbnail$p_2;return new(e||(e=n("Promise")))(function(e,n){var f=r("EventListener").listen(_,"seeked",function(){f.remove(),p.fillStyle=c,p.textAlign=d,t.$CanvasVideoThumbnail$p_9(m,p),p=r("VideoThumbnail_UNTYPED").addTextToCanvasContext(p,o,a,i,l,s,u,c,d),r("promiseDone")(r("canvasToBlob")(m,"image/jpeg").then(e,n))});_.currentTime=t.$CanvasVideoThumbnail$p_3})},a.$CanvasVideoThumbnail$p_9=function(t,n){var e=this.$CanvasVideoThumbnail$p_2;this.$CanvasVideoThumbnail$p_4||this.$CanvasVideoThumbnail$p_5?(t.width=this.$CanvasVideoThumbnail$p_4?this.$CanvasVideoThumbnail$p_4:e.videoWidth,t.height=this.$CanvasVideoThumbnail$p_5?this.$CanvasVideoThumbnail$p_5:e.videoHeight,this.$CanvasVideoThumbnail$p_10(t,n)):(t.width=e.videoWidth,t.height=e.videoHeight,n.drawImage(e,0,0,t.width,t.height))},a.$CanvasVideoThumbnail$p_10=function(t,n){var e=this.$CanvasVideoThumbnail$p_2,r=this.$CanvasVideoThumbnail$p_6,o=this.$CanvasVideoThumbnail$p_7,a=this.$CanvasVideoThumbnail$p_4?this.$CanvasVideoThumbnail$p_4:t.width,i=this.$CanvasVideoThumbnail$p_5?this.$CanvasVideoThumbnail$p_5:t.height;n.drawImage(e,r,o,a,i,0,0,t.width,t.height)},o})(r("VideoThumbnail_UNTYPED"));l.default=s}),98);
__d("HTMLMediaElementReadyStates",[],(function(t,n,r,o,a,i){var e={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},l=e;i.default=l}),66);
__d("LSLocalApplyOptimisticMessageWithAttachments",["LSArrayGetObjectAt","LSLocalApplyOptimisticMessage","LSSetMessageDisplayedContentTypes"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return t.storedProcedure(n("LSLocalApplyOptimisticMessage"),e[0],e[1],e[2],e[3],e[4],e[5],e[6],void 0,e[7],e[8],e[9],e[10],void 0,e[12],!0).then(function(e){var t;return t=e,r[0]=t[0],r[1]=t[1],t})},function(o){return r[2]=t.i64.of_int32(e[11].length),t.i64.gt(r[2],t.i64.cast([0,0]))?t.loopAsync(r[2],function(o){return r[3]=o,t.sequence([function(o){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),e[11],r[3]).then(function(e){var t;return t=e,r[4]=t[0],r[5]=t[1],t})},function(n){return r[6]=r[4].get("attachment_fbid"),r[7]=r[4].get("offline_attachment_id"),r[8]=r[4].get("attachment_type"),r[9]=r[4].get("filename"),r[10]=r[4].get("filesize"),r[11]=r[4].get("attachment_index"),r[12]=r[4].get("has_media"),r[13]=r[4].get("has_xma"),r[14]=r[4].get("playable_url"),r[15]=r[4].get("playable_url_mime_type"),r[16]=r[4].get("playable_duration_ms"),r[17]=r[4].get("preview_url"),r[18]=r[4].get("preview_url_mime_type"),r[19]=r[4].get("mini_preview"),r[20]=r[4].get("preview_width"),r[21]=r[4].get("preview_height"),r[22]=r[4].get("xma_layout_type"),r[23]=r[4].get("xmas_template_type"),r[24]=r[4].get("cta1_title"),r[25]=r[4].get("cta2_title"),r[26]=r[4].get("cta3_title"),r[27]=r[4].get("image_url"),r[28]=r[4].get("action_url"),r[29]=r[4].get("title_text"),r[30]=r[4].get("subtitle_text"),r[31]=r[4].get("description_text"),r[32]=r[4].get("source_text"),r[33]=r[4].get("original_file_hash"),r[34]=r[4].get("sound_bite_client_sound_key"),r[35]=r[4].get("sound_bite_visual"),r[36]=r[4].get("ephemeral_media_state"),r[37]=r[4].get("waveform_data"),r[38]=r[4].get("sampling_frequency_hz"),r[17]!==void 0?r[39]=r[17]:r[39]=r[14],t.filter(t.db.table(16).fetch([[[e[1],r[0],r[6]]]]),function(n){return t.i64.eq(n.threadKey,e[1])&&t.i64.eq(t.i64.cast([0,0]),t.i64.cast([0,0]))&&n.messageId===r[0]&&n.attachmentFbid===r[6]&&t.i64.gt(n.authorityLevel,t.i64.cast([0,20]))}).next().then(function(n){var o=n.done,a=n.value;return o?t.db.table(16).put({threadKey:e[1],messageId:r[0],attachmentFbid:r[6],timestampMs:r[1],offlineAttachmentId:r[7],attachmentType:r[8],filename:r[9],filesize:r[10],attachmentIndex:r[11],hasMedia:r[12],hasXma:r[13],isSharable:!1,playableUrl:r[14],playableUrlMimeType:r[15],playableDurationMs:r[16],previewUrl:r[39],previewUrlMimeType:r[18],miniPreview:r[19],previewWidth:r[20],previewHeight:r[21],xmaLayoutType:r[22],xmasTemplateType:r[23],cta1Title:r[24],cta2Title:r[25],cta3Title:r[26],imageUrl:r[27],actionUrl:r[28],titleText:r[29],subtitleText:r[30],descriptionText:r[31],sourceText:r[32],ephemeralMediaState:r[36],originalFileHash:r[33],authorityLevel:t.i64.cast([0,20]),samplingFrequencyHz:r[38],waveformData:r[37]}):0})}])}):t.resolve()},function(o){return r[2]=t.i64.of_int32(e[11].length),t.i64.gt(r[2],t.i64.cast([0,0]))?t.storedProcedure(n("LSSetMessageDisplayedContentTypes"),e[1],r[0],r[1],e[3],!1,t.i64.neq(e[6],void 0)):t.resolve()},function(e){var t;return t=[r[0],r[1]],o[0]=t[0],o[1]=t[1],t}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxLocalApplyOptimisticMessageWithAttachmentsStoredProcedure",e.__tables__=["attachments"],a.exports=e}),null);
__d("LSLocalApplyOptimisticMessageWithAttachmentsStoredProcedure",["LSLocalApplyOptimisticMessageWithAttachments","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSLocalApplyOptimisticMessageWithAttachments"),a.senderId,a.threadKey,a.threadType,a.text,a.snippet,a.snippetHasEmoji,a.stickerId,a.replySourceId,a.replySourceType,a.replySourceTypeV2,a.isForwarded,a.attachments,a.mentionData);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSOptimisticSendAttachmentForward",["LSInsertOptimisticAttachment","LSIssueNewTaskWithExtraOperationsAndGetTaskID","LSLocalApplyOptimisticMessage","LSUpdateOptimisticAttachmentPreview"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return r[1]=e[3]===""?void 0:e[3],r[1]!==void 0?t.sequence([function(n){return t.forEach(t.filter(t.db.table(16).fetch([[[e[1],r[1]]]]),function(n){return t.i64.eq(n.threadKey,e[1])&&n.messageId===r[1]&&t.i64.eq(n.authorityLevel,t.i64.cast([0,20]))}),function(n){var r=n.update,o=n.item;return r({attachmentFbid:t.i64.to_string(e[7])})})},function(e){return r[0]=r[1]}]):t.sequence([function(o){return t.storedProcedure(n("LSLocalApplyOptimisticMessage"),e[0],e[1],e[2],e[4],e[5],e[6],void 0,void 0,void 0,void 0,t.i64.cast([0,3]),void 0,void 0,void 0,!0).then(function(e){var t;return t=e,r[2]=t[0],r[3]=t[1],t})},function(o){return t.filter(t.db.table(16).fetch(),function(n){return n.attachmentFbid===t.i64.to_string(e[7])}).next().then(function(o,a){var i=o.done,l=o.value;return i?t.storedProcedure(n("LSInsertOptimisticAttachment"),e[1],r[3],r[2],r[2],t.i64.to_string(e[7]),t.i64.cast([0,2]),void 0,t.i64.cast([0,0]),void 0,!0,!1):(a=l.item,t.sequence([function(o){return t.storedProcedure(n("LSInsertOptimisticAttachment"),e[1],r[3],r[2],r[2],t.i64.to_string(e[7]),a.attachmentType,a.filename,a.attachmentIndex,a.attributionAppId,!0,!1)},function(o){return t.storedProcedure(n("LSUpdateOptimisticAttachmentPreview"),e[1],r[2],t.i64.to_string(e[7]),a.playableUrl,a.playableUrlFallback,a.playableUrlExpirationTimestampMs,a.playableUrlMimeType,a.previewUrl,a.previewUrlFallback,a.previewUrlExpirationTimestampMs,a.previewUrlMimeType,a.previewWidth,a.previewHeight,a.titleText)}]))})},function(e){return r[0]=r[2]}])},function(o){return t.sequence([function(n){return r[2]=t.createArray(),r[6]=(r[2].push(e[7]),r[2]),t.db.table(9).fetch([[[e[1]]]]).next().then(function(e,n){var o=e.done,a=e.value;return o?r[3]=t.i64.cast([0,1]):(n=a.item,r[7]=n.syncGroup,t.i64.neq(r[7],void 0)?r[6]=r[7]:r[6]=t.i64.cast([0,1]),r[3]=r[6])})},function(o){return t.storedProcedure(n("LSIssueNewTaskWithExtraOperationsAndGetTaskID"),t.i64.to_string(e[1]),t.i64.cast([0,46]),"",void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),r[3],void 0,t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[5]=t[0],t})},function(n){return t.db.table(31).add({taskId:r[5],threadKey:e[1],offlineThreadingId:r[0],threadAttributionSource:e[8],sendType:t.i64.cast([0,4]),markThreadRead:!1,initiatingSource:e[9]})}])},function(e){return o[0]=r[0]}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxOptimisticSendAttachmentForwardStoredProcedure",e.__tables__=["attachments","threads","messages_optimistic_context"],a.exports=e}),null);
__d("LSOptimisticSendAttachmentForwardStoredProcedure",["LSOptimisticSendAttachmentForward","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSOptimisticSendAttachmentForward"),a.senderId,a.threadKey,a.threadType,a.offlineThreadingId,a.text,a.snippet,a.snippetHasEmoji,a.forwardedAttachmentFbid,a.source,a.initiatingSource);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("LSOptimisticSendXMAMessageForwardFromSecureThread",["LSArrayGetObjectAt","LSIssueNewTaskWithExtraOperationsAndGetTaskID","LSLocalApplyOptimisticMessage","LSSetMessageDisplayedContentTypes","LSUpdateOptimisticAttachmentPreview"],(function(t,n,r,o,a,i){function e(){var e=arguments,t=e[e.length-1],r=[],o=[];return t.sequence([function(a){return t.sequence([function(o){return t.storedProcedure(n("LSLocalApplyOptimisticMessage"),e[0],e[1],e[2],e[3],void 0,void 0,void 0,void 0,void 0,void 0,t.i64.cast([0,3]),e[4],void 0,void 0,!0).then(function(e){var t;return t=e,r[0]=t[0],r[1]=t[1],t})},function(o){return r[3]=t.i64.of_int32(e[6].length),t.i64.gt(r[3],t.i64.cast([0,0]))?t.loopAsync(r[3],function(o){return r[4]=o,t.sequence([function(o){return t.nativeTypeOperation("Array",n("LSArrayGetObjectAt"),e[6],r[4]).then(function(e){var t;return t=e,r[5]=t[0],r[6]=t[1],t})},function(o){return r[7]=r[5].get("attachment_fbid"),r[8]=r[5].get("offline_attachment_id"),r[9]=r[5].get("attachment_type"),r[10]=r[5].get("filename"),r[11]=r[5].get("filesize"),r[12]=r[5].get("attachment_index"),r[13]=r[5].get("has_media"),r[14]=r[5].get("has_xma"),r[15]=r[5].get("playable_url"),r[16]=r[5].get("playable_url_mime_type"),r[17]=r[5].get("playable_duration_ms"),r[18]=r[5].get("preview_url"),r[19]=r[5].get("preview_url_mime_type"),r[20]=r[5].get("mini_preview"),r[21]=r[5].get("preview_width"),r[22]=r[5].get("preview_height"),r[23]=r[5].get("xma_layout_type"),r[24]=r[5].get("xmas_template_type"),r[25]=r[5].get("cta1_title"),r[26]=r[5].get("cta2_title"),r[27]=r[5].get("cta3_title"),r[28]=r[5].get("image_url"),r[29]=r[5].get("action_url"),r[30]=r[5].get("title_text"),r[31]=r[5].get("subtitle_text"),r[32]=r[5].get("description_text"),r[33]=r[5].get("source_text"),r[34]=r[5].get("original_file_hash"),r[35]=r[5].get("sound_bite_client_sound_key"),r[36]=r[5].get("sound_bite_visual"),r[37]=r[5].get("ephemeral_media_state"),t.sequence([function(n){return t.forEach(t.filter(t.db.table(16).fetch([[[e[1],r[0],r[7]]]]),function(n){return t.i64.eq(n.threadKey,e[1])&&t.i64.eq(t.i64.cast([0,0]),t.i64.cast([0,0]))&&n.messageId===r[0]&&n.attachmentFbid===r[7]&&t.i64.lt(n.authorityLevel,t.i64.cast([0,20]))}),function(e){return e.delete()})},function(n){return t.db.table(16).add({threadKey:e[1],messageId:r[0],attachmentFbid:r[7],timestampMs:r[1],offlineAttachmentId:r[8],attachmentType:r[9],filename:r[10],filesize:r[11],attachmentIndex:r[12],hasMedia:r[13],hasXma:r[14],isSharable:!1,playableUrl:r[15],playableUrlMimeType:r[16],playableDurationMs:r[17],previewUrl:r[18],previewUrlMimeType:r[19],miniPreview:r[20],previewWidth:r[21],previewHeight:r[22],xmaLayoutType:r[23],xmasTemplateType:r[24],cta1Title:r[25],cta2Title:r[26],cta3Title:r[27],imageUrl:r[28],actionUrl:r[29],titleText:r[30],subtitleText:r[31],descriptionText:r[32],sourceText:r[33],ephemeralMediaState:r[37],originalFileHash:r[34],authorityLevel:t.i64.cast([0,20])})},function(o){return t.storedProcedure(n("LSSetMessageDisplayedContentTypes"),e[1],r[0],r[1],e[3],!1,!1)},function(o){return t.storedProcedure(n("LSUpdateOptimisticAttachmentPreview"),e[1],r[0],r[7],r[15],void 0,void 0,r[16],r[18],void 0,void 0,r[19],r[21],r[22],r[30])}])}])}):t.resolve()},function(o){return t.storedProcedure(n("LSIssueNewTaskWithExtraOperationsAndGetTaskID"),t.i64.to_string(e[1]),t.i64.cast([0,46]),"",void 0,void 0,t.i64.cast([0,0]),t.i64.cast([0,0]),t.i64.cast([0,1]),void 0,t.i64.cast([0,0]),void 0,t.i64.cast([0,0])).then(function(e){var t;return t=e,r[2]=t[0],t})},function(n){return t.db.table(31).add({taskId:r[2],threadKey:e[1],offlineThreadingId:r[0],threadAttributionSource:e[5],sendType:t.i64.cast([0,11]),markThreadRead:!1})},function(e){return o[0]=r[0]}])},function(e){return t.resolve(o)}])}e.__sproc_name__="LSMailboxOptimisticSendXMAMessageForwardFromSecureThreadStoredProcedure",e.__tables__=["attachments","messages_optimistic_context"],a.exports=e}),null);
__d("LSOptimisticSendXMAMessageForwardFromSecureThreadStoredProcedure",["LSOptimisticSendXMAMessageForwardFromSecureThread","LSSynchronousPromise","Promise","cr:8709"],(function(t,n,r,o,a,i,l){var e;function s(t,a){var i=t.storedProcedure(r("LSOptimisticSendXMAMessageForwardFromSecureThread"),a.senderId,a.threadKey,a.threadType,a.text,a.isForwarded,a.source,a.attachments);return(e||(e=n("Promise"))).resolve(o("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(i))}l.default=s}),98);
__d("MAWDocumentPreProcess",["Promise","WABlobToArrayBuffer","WATagsLogger","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=o("WATagsLogger").TAGS(["MAWDocumentPreProcess"]);function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return c.DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["start document preprocess"]))),(u||(u=n("Promise"))).resolve({file:e,filename:e.name,plaintext:yield o("WABlobToArrayBuffer").blobToArrayBuffer(e),type:"document"})}),m.apply(this,arguments)}function p(r){c.DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["start optimistic document preprocess"])));var o=t.URL.createObjectURL(r);return(u||(u=n("Promise"))).resolve({file:r,filename:r.name,type:"document",url:o})}l.documentPreprocess=d,l.optimisticDocumentPreprocess=p}),98);
__d("MAWFetchXMADataUtils",["FBLogger","LSXmaContentType","MAWFetchXMABlob","MAWGetImageSpec","MAWParseXMAFBConfig","Promise","WAArmadilloXMA.pb","asyncToGeneratorRuntime","sendToSentQPLLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s={failed_to_fetch_blob_for_xma_share:"Failed to fetch blob xma data for MAWShareAttachent",failed_to_fetch_json_for_xma_share:"Failed execute MAWShareAttachment_LinkPreviewQuery for MAWShareAttachent",failed_to_parse_json_for_xma_share:"Failed to fetch blob xma data for MAWShareAttachent"};function u(e){var t=Object.entries(r("LSXmaContentType")).find(function(t){var n=t[0],r=t[1];return e===r&&o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE[n]!=null}),n=t!=null?o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE[t[0]]:void 0;if(n!==void 0)return o("MAWParseXMAFBConfig").isFBSupportedTargetType({fbTargetType:n,silentExposure:!0})?n:(r("FBLogger")("messenger_web_sharing").mustfix("Unsupported XMA Target Type in sending path: "+n),o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE)}function c(e,t){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){var a=t.favicon_blob,i=t.header_image_blob,l=t.overlayIconGlyph,s=t.preview_blob,u=s==null?void 0:new File([s],"preview",{type:s.type}),c=a==null?void 0:new File([a],"favicon",{type:a.type}),d=i==null?void 0:new File([i],"header",{type:i.type});o("sendToSentQPLLogger").markSendToSentPoint(r,"preview_favicon_spec_start");var m=l===o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.PRIVATE?(e||(e=n("Promise"))).resolve({height:2,width:2}):u!=null?o("MAWGetImageSpec").getImageSpec_DEPRECATED(u):(e||(e=n("Promise"))).resolve(),p=c!=null?o("MAWGetImageSpec").getImageSpec_DEPRECATED(c):(e||(e=n("Promise"))).resolve(),_=d!=null?o("MAWGetImageSpec").getImageSpec_DEPRECATED(d):(e||(e=n("Promise"))).resolve(),f=yield(e||(e=n("Promise"))).all([m,p,_]),g=f[0],h=f[1],y=f[2];o("sendToSentQPLLogger").markSendToSentPoint(r,"preview_favicon_spec_ready");var C=u==null||g==null?void 0:{file:u,height:g.height,width:g.width},b=c==null||h==null?void 0:{file:c,height:h.height,width:h.width},v=d==null||y==null?void 0:{file:d,height:y.height,width:y.width};return{faviconFileArgs:b,headerImageFileArgs:v,previewFileArgs:C}}),d.apply(this,arguments)}function m(e,t,n,r,o,a){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i,l,u,c){var d=yield(e||(e=n("Promise"))).all([[(t==null?void 0:t.startsWith("ls"))===!0?null:t,"favicon"],[a,"image"],[i,"preview"],[l,"header_image"]].map(function(e){return o("MAWFetchXMABlob").fetchBlob({descriptionForLogging:"MAWFetchXMAData_"+e[1],url:e[0],xmaContentType:c}).then(function(e){return e!=null?e:void 0})})).catch(function(e){return u.forEach(function(e){o("sendToSentQPLLogger").markSendToSentFail(e,"failed_to_fetch_blob_for_xma_share")}),r("FBLogger")("messenger_web_sharing").catching(e).mustfix(s.failed_to_fetch_blob_for_xma_share),[void 0,void 0,void 0,void 0]}),m=d[0],p=d[1],_=d[2],f=d[3];return[m,p,_,f]}),p.apply(this,arguments)}l.XMA_DATA_ERRORS=s,l.convertXmaContentTypeToMessageType=u,l.makeXMAFileArgs=c,l.getPreviewBlobs=m}),98);
__d("MAWFetchXMAData_fetchXmaPreviewDataQuery_facebookRelayOperation",[],(function(t,n,r,o,a,i){a.exports="9840669832713841"}),null);
__d("MAWFetchXMAData_fetchXmaPreviewDataQuery.graphql",["MAWFetchXMAData_fetchXmaPreviewDataQuery_facebookRelayOperation"],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"url"}],t=[{alias:null,args:[{fields:[{kind:"Variable",name:"url",variableName:"url"}],kind:"ObjectValue",name:"params"}],concreteType:"XFBXMAPreviewData",kind:"LinkedField",name:"xma_preview_data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_receiver_fetch_supported",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_public",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"post_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"default_cta_title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"header_title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"subtitle_text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title_text",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"xma_content_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"favicon_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"header_image_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"preview_url",storageKey:null},{alias:null,args:null,concreteType:"XFBXMAPreviewDataCtaDataConnection",kind:"LinkedField",name:"cta_data",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBXMACtaData",kind:"LinkedField",name:"nodes",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"cta_title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cta_action_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cta_native_url",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"MAWFetchXMAData_fetchXmaPreviewDataQuery",selections:t,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"MAWFetchXMAData_fetchXmaPreviewDataQuery",selections:t},params:{id:n("MAWFetchXMAData_fetchXmaPreviewDataQuery_facebookRelayOperation"),metadata:{},name:"MAWFetchXMAData_fetchXmaPreviewDataQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("MAWUnshimUrl",["CometLinkShimUtils"],(function(t,n,r,o,a,i,l){"use strict";function e(e){if(e!=null){var t=o("CometLinkShimUtils").getLinkShimInfo(e,void 0,void 0,void 0,void 0,void 0,!0);return t.shimmed?t.unshimmedHref:e}}l.unshimUrl=e}),98);
__d("MAWFetchXMAData",["fbt","CometRelay","ConstUriUtils","FBLogger","LSXmaContentType","MAWFetchXMADataUtils","MAWFetchXMAData_fetchXmaPreviewDataQuery.graphql","MAWUnshimUrl","MSGDataclassTypes.flow","Promise","WAArmadilloXMA.pb","asyncToGeneratorRuntime","getJSEnumSafe","isFacebookURI","isStringNullOrEmpty","sendToSentQPLLogger"],(function(t,n,r,o,a,i,l,s){"use strict";var e,u;function c(e,t){var n;return t.forEach(function(e){o("sendToSentQPLLogger").addSendToSentAnnotations(e,{string:{xma_data_result:"private"}})}),{defaultCTA:{actionUrl:o("MAWUnshimUrl").unshimUrl(e),buttonType:(n=o("WAArmadilloXMA.pb")).EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:o("MAWUnshimUrl").unshimUrl(e),title:s._(/*BTDS*/"_j[\"Private post\",\"599d20d959e0009397c73fb9edb426dd\",1]").toString()},linkType:"internal",overlayIconGlyph:n.EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.PRIVATE,preview_blob:void 0,title_text:s._(/*BTDS*/"Facebook").toString(),transportLayerForLogging:"sender_copy",xma_message_type:n.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE,xmaTargetTypeForLogging:n.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE}}function d(t,r){return o("CometRelay").fetchQuery(t,e!==void 0?e:e=n("MAWFetchXMAData_fetchXmaPreviewDataQuery.graphql"),{url:r}).toPromise()}function m(e,t,n){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var a,i,l,s,u,m,p=yield d(e,t).catch(function(e){n.forEach(function(t){o("sendToSentQPLLogger").markSendToSentFail(t,"failed_to_fetch_json_for_xma_share",e)}),r("FBLogger")("messenger_web_sharing").catching(e).mustfix(o("MAWFetchXMADataUtils").XMA_DATA_ERRORS.failed_to_fetch_json_for_xma_share)});n.forEach(function(e){o("sendToSentQPLLogger").markSendToSentPoint(e,"fetch_json_for_xma_share_end")});var _=p==null?void 0:p.xma_preview_data;if(_==null)return n.forEach(function(e){o("sendToSentQPLLogger").addSendToSentAnnotations(e,{string:{xma_data_result:"empty"}})}),c(t,n);if(_.is_public!==!0)return c(t,n);n.forEach(function(e){o("sendToSentQPLLogger").addSendToSentAnnotations(e,{string:{xma_data_result:"public"}})});var f={defaultCTA:{actionUrl:o("MAWUnshimUrl").unshimUrl(t),buttonType:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:o("MAWUnshimUrl").unshimUrl(t),title:(a=_.default_cta_title)!=null?a:void 0},linkType:"internal",title_text:(i=(l=_.title_text)!=null?l:_.header_title)!=null?i:void 0},g=r("getJSEnumSafe")(r("LSXmaContentType"),_.xma_content_type),h=o("MAWFetchXMADataUtils").convertXmaContentTypeToMessageType(g),y=_.post_id,C=_.is_receiver_fetch_supported===!0;if(C&&y!=null){var b={__typename:"XMSGMsgrXmaContentRefDataclass",action_type:o("MSGDataclassTypes.flow").XmsgMsgrXmaActionType.Share,content_type:o("MSGDataclassTypes.flow").XmsgMsgrReceiverFetchContentType.Statusupdate,fetch_params:{__typename:"XMSGMsgrReceiverFetchXmaStatusUpdateFetchParams",post_id:y},xma_content_type:r("getJSEnumSafe")(r("LSXmaContentType"),_.xma_content_type),xma_layout_type:o("MSGDataclassTypes.flow").XmsgMsgrReceiverFetchXmaLayoutType.Single};return babelHelpers.extends({},f,{contentRef:JSON.stringify(b),transportLayerForLogging:"receiver_fetch",xma_message_type:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH,xmaTargetTypeForLogging:h})}var v=yield o("MAWFetchXMADataUtils").getPreviewBlobs(_.favicon_url,null,_.preview_url,_.header_image_url,n,g),S=v[0],R=v[1],L=v[2],E=v[3];return babelHelpers.extends({},f,{ctas:(s=_.cta_data)==null||(s=s.nodes)==null?void 0:s.map(function(e){var t,n=o("MAWUnshimUrl").unshimUrl(r("isStringNullOrEmpty")(e.cta_action_url)?void 0:e.cta_action_url),a=o("MAWUnshimUrl").unshimUrl(r("isStringNullOrEmpty")(e.cta_native_url)?void 0:e.cta_native_url);return{actionUrl:n,buttonType:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,ctaType:"xma_web_url",nativeUrl:a,title:(t=e.cta_title)!=null?t:void 0}}),favicon_blob:S!=null?S:void 0,header_image_blob:E!=null?E:void 0,header_title:r("isStringNullOrEmpty")(_.title_text)?void 0:(u=_.header_title)!=null?u:void 0,preview_blob:L!=null?L:void 0,subtitle_text:(m=_.subtitle_text)!=null?m:void 0,transportLayerForLogging:"sender_copy",xma_message_type:h,xmaTargetTypeForLogging:h})}),p.apply(this,arguments)}function _(e,t,a){var i,l=o("ConstUriUtils").getUri(t),s=l==null||(i=l.setSubDomain("www"))==null?void 0:i.toString();if(s==null)return(u||(u=n("Promise"))).resolve({linkType:"unknown",transportLayerForLogging:"sender_copy",xmaTargetTypeForLogging:null});var c=o("MAWUnshimUrl").unshimUrl(t);if(c!=null){var d=o("ConstUriUtils").getUri(c);if(d!=null&&!r("isFacebookURI")(d))return(u||(u=n("Promise"))).resolve({linkType:"external",transportLayerForLogging:"sender_copy",xma_message_type:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE,xmaTargetTypeForLogging:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE})}return a.forEach(function(e){o("sendToSentQPLLogger").markSendToSentPoint(e,"fetch_json_for_xma_share_start")}),m(e,s,a)}l.fetchXMAData=_}),226);
__d("MAWThreadMappingUtils",["FBLogger","LSMessagingThreadTypeUtil","MAWJids","MAWMiActOnActThreadReadyInstrumentation","Promise","ReQL","ReQLSubscribe","asyncToGeneratorRuntime","err","setTimeout"],(function(t,n,r,o,a,i,l){"use strict";var e,s=3e4;function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.threads).getKeyRange(t));return n==null?(r("FBLogger")("messenger_web").mustfix("[onActThreadReady] Thread is not ready to be used."),null):o("LSMessagingThreadTypeUtil").isGroup(n.threadType)}),c.apply(this,arguments)}function d(t,a){return(e||(e=n("Promise"))).all([u(t,a),o("ReQL").firstAsync(o("ReQL").fromTableAscending(t.mi_act_mapping_table).getKeyRange(a))]).then(function(e){var t=e[0],n=e[1];return n==null||t==null?(r("FBLogger")("messenger_web").mustfix("[onActThreadReady] Thread is not ready to be used."),null):o("MAWJids").convertIntJidToChatJid(n.jid,t)})}function m(e,t){return o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.mi_act_mapping_table).getKeyRange(t)).then(function(e){return e==null?(r("FBLogger")("messenger_web").mustfix("[onActThreadReady] Thread is not ready to be used."),null):e.jid})}function p(e,t,n){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i){var l,c=null,m=(l=o("MAWMiActOnActThreadReadyInstrumentation")).getOnActThreadReadyInstanceKey(i);l.startQPL(m,i,a,"getChatJidOnceInThreadMappingTable"),l.addPointQPL(m,"get_existing_int_jid_from_mapping_table_start");var p=yield d(t.tables,a);if(l.addPointQPL(m,"get_existing_int_jid_from_mapping_table_end"),p!=null)return o("MAWMiActOnActThreadReadyInstrumentation").endSuccessQPL(m),(e||(e=n("Promise"))).resolve(p);var _=yield u(t.tables,a);if(_==null)throw o("MAWMiActOnActThreadReadyInstrumentation").endFailureQPL(m,"thread_not_ready_to_be_used"),r("FBLogger")("messenger_web").mustfixThrow("Thread is not ready to be used.");return o("MAWMiActOnActThreadReadyInstrumentation").addPointQPL(m,"subscribe_to_mapping_table_start"),new(e||(e=n("Promise")))(function(e,n){var i=o("ReQL").fromTableDescending(t.tables.mi_act_mapping_table).getKeyRange(a),l=o("ReQLSubscribe").subscribeToFirst(i,function(t){t!=null&&(c!=null&&window.clearTimeout(c),l(),o("MAWMiActOnActThreadReadyInstrumentation").addPointQPL(m,"subscribe_to_mapping_table_end"),o("MAWMiActOnActThreadReadyInstrumentation").endSuccessQPL(m),e(o("MAWJids").convertIntJidToChatJid(t.jid,_)))});c=r("setTimeout")(function(){l(),o("MAWMiActOnActThreadReadyInstrumentation").endFailureQPL(m,"subscribe_to_mapping_table_timeout"),n(r("err")("Timeout waiting for int jid to be populated in mapping table."))},s)})}),_.apply(this,arguments)}function f(e,t,n){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i){var l,u=null,c=(l=o("MAWMiActOnActThreadReadyInstrumentation")).getOnActThreadReadyInstanceKey(i);l.startQPL(c,i,a,"getIntJidOnceInThreadMappingTable"),l.addPointQPL(c,"get_existing_int_jid_from_mapping_table_start");var d=yield m(t.tables,a);return l.addPointQPL(c,"get_existing_int_jid_from_mapping_table_end"),d!=null?(o("MAWMiActOnActThreadReadyInstrumentation").endSuccessQPL(c),(e||(e=n("Promise"))).resolve(d)):(o("MAWMiActOnActThreadReadyInstrumentation").addPointQPL(c,"subscribe_to_mapping_table_start"),new(e||(e=n("Promise")))(function(e,n){var i=o("ReQL").fromTableDescending(t.tables.mi_act_mapping_table).getKeyRange(a),l=o("ReQLSubscribe").subscribeToFirst(i,function(t){t!=null&&(u!=null&&window.clearTimeout(u),l(),o("MAWMiActOnActThreadReadyInstrumentation").addPointQPL(c,"subscribe_to_mapping_table_end"),o("MAWMiActOnActThreadReadyInstrumentation").endSuccessQPL(c),e(t.jid))});u=r("setTimeout")(function(){l(),o("MAWMiActOnActThreadReadyInstrumentation").endFailureQPL(c,"subscribe_to_mapping_table_timeout"),n(r("err")("Timeout waiting for int jid to be populated in mapping table."))},s)}))}),g.apply(this,arguments)}l.isThreadGroup=u,l.getChatJidFromMappingTable=d,l.getIntJidFromMappingTable=m,l.getChatJidOnceInThreadMappingTable=p,l.getIntJidOnceInThreadMappingTable=f}),98);
__d("MAWGetProtocolMsgIdByMsgIdInUI",["I64","LSDatabaseSingleton","MAWBridgeSendAndReceive","MAWMpsGating","MAWThreadMappingUtils","MAWUserJidWrapper","WAJids","WAStanzaUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=o("WAJids").createJidUtils({platform:"msgr"});function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var r=yield(e||(e=o("LSDatabaseSingleton"))).getLSDatabaseSingletonPromiseOrValue();return r.runInTransaction((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var n=yield e.messages.index("messageId").get(t);if(n==null)return null;var r=yield o("MAWThreadMappingUtils").getChatJidFromMappingTable(e,n.threadKey);if(r!=null)return{author:u.toUserJid((s||(s=o("I64"))).to_float(n.senderId).toString()),chat:r,externalId:o("WAStanzaUtils").toStanzaId(n.offlineThreadingId)}});return function(t){return e.apply(this,arguments)}})(),"readonly",void 0,void 0,i.id+":33")}),d.apply(this,arguments)}var m=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){if(o("MAWMpsGating").isFullMpsEnabled())return c(e);if(o("MAWMpsGating").isMpsMessageRendering()){var t=yield c(e);return t!=null&&o("MAWUserJidWrapper").getMyUserJid()===t.author?{author:"@me",chat:t.chat,externalId:t.externalId}:t}return p(e)});return function(n){return e.apply(this,arguments)}})(),p=function(t){return o("MAWBridgeSendAndReceive").sendAndReceive("backend","getProtocolMsgIdByMsgId",{msgId:t})};l.getProtocolMsgIdByMsgIdUI=m}),98);
__d("MAWSendFileMsgTypes",["WAStanzaUtils"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return e}function s(e){return o("WAStanzaUtils").toStanzaId(e)}l.toOfflineAttachmentIDFromStanzaId=e,l.toOfflineAttachmentIDFromString=s}),98);
__d("MAWSecureAttachmentGroupingUtils",["I64","LSIntEnum","MAWSendFileMsgTypes","MessagingAttachmentType","uuidv4"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t){var n=t.reduce(function(t,n){return(e||(e=o("I64"))).equal(n.attachmentType,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE))?t.mediaStagingsImage.push(n):t.mediaStagingsOther.push(n),t},{mediaStagingsImage:[],mediaStagingsOther:[]}),a=n.mediaStagingsImage,i=n.mediaStagingsOther;return[].concat(a,i)}function c(t){var n=new Map,a=t.filter(function(t){return(e||(e=o("I64"))).equal(t.attachmentType,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE))}),i=a.length;if(i>1){var l=r("uuidv4")();a.forEach(function(e,t){n.set(o("MAWSendFileMsgTypes").toOfflineAttachmentIDFromString(e.offlineAttachmentId),{groupId:l,groupIndex:t,groupSize:i})})}return n}function d(e){var t=new Map,n=e.length;if(n>1){var o=r("uuidv4")();e.forEach(function(e,r){t.set(e,{groupId:o,groupIndex:r,groupSize:n})})}return t}l.orderMediaStagingsForGrouping=u,l.generateMediaGroupMetadataForMediaStagings=c,l.generateMediaGroupMetadataForMessageIds=d}),98);
__d("MAWThreadId",["LSMessagingThreadTypeUtil","ReQL","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.threads).getKeyRange(t));return n==null?void 0:n.threadType}),s.apply(this,arguments)}function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var r=yield e(t,n);return r==null?!1:o("LSMessagingThreadTypeUtil").isArmadilloSecure(r)}),c.apply(this,arguments)}function d(e,t){return o("ReQL").firstAsync(o("ReQL").fromTableAscending(e.threads).getKeyRange(t))}l.isSecureThreadKey=u,l.getThread=d}),98);
__d("MAWForwardMessage",["MAWBridgeSendAndReceive","MAWCreateOneToOneThread","MAWExternalId","MAWGetEphemeralSettings","MAWGetProtocolMsgIdByMsgIdInUI","MAWMessageSendReporter","MAWMiActOnActThreadReady","MAWSecureAttachmentGroupingUtils","MAWThreadId","Promise","WAResultOrError","asyncToGeneratorRuntime","qpl"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e,t,n,r){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=yield o("MAWThreadId").isSecureThreadKey(e.tables,t);if(!a){var i=yield o("MAWCreateOneToOneThread").call(e,t,void 0,"MAWForwardMessage",r),l=i.jid;return n(l,!0)}var s=yield o("MAWMiActOnActThreadReady").waitForACTThreadReady(e.tables,t,"MAWForwardMessage"),u=s.chatJid;return n(u,!1)}),u.apply(this,arguments)}function c(e,t,n,r,o,a){return p(e,t,n,r,o,void 0,a)}function d(e,t,n,r,o){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r,a,i,l){var s=o("MAWSecureAttachmentGroupingUtils").generateMediaGroupMetadataForMessageIds(a);yield(e||(e=n("Promise"))).allSettled([a.map(function(e){return p(t,r,e,i,l,s.get(e))})])}),m.apply(this,arguments)}function p(e,t,n,a,i,l,u){var c=o("MAWExternalId").generateExternalId();return s(e,t,function(s,d){return o("MAWGetProtocolMsgIdByMsgIdInUI").getProtocolMsgIdByMsgIdUI(n).then(function(n){return n!=null?o("MAWGetEphemeralSettings").getEphemeralSetting(s,t).then(function(t){var m=o("MAWBridgeSendAndReceive").sendAndReceive("backend","forwardMsg",{args:{args:{mediaGroupMetadata:l,source:a},chatJid:s,ephemeralSetting:t!=null?t:void 0,externalId:c,isFirstMsg:d,protocolMsgId:n,textWithSubstitutions:u},qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:i});return o("MAWMessageSendReporter").MAWMessageSendReporter({chatJid:s,externalId:c},m,{qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:i},e)}):o("WAResultOrError").makeResult({description:"unexpected null protocolMsgId",messageType:"fixMe"})})},i)}l.maybeCreateNewThreadAndCallback=s,l.forwardMessage=c,l.forwardMessageBatch=d}),98);
__d("MAWForwardMessageFromSecureThread.react",["FBLogger","I64","LSFactory","LSHotEmojiSize","LSInsertNewMediaSendStoredProcedure","LSIntEnum","LSLocalApplyOptimisticMessageWithAttachmentsStoredProcedure","LSMailboxType","LSMarkSubJobCompletedV2StoredProcedure","LSOptimisticSendMessageV2StoredProcedure","LSOptimisticSendXMAMessageForwardFromSecureThreadStoredProcedure","LSShape","LSVec","MAWAudioUtils","MAWBridgeSendAndReceive","MAWDbMedia","MAWMpsGating","MWPComposerMediaUploadUtil","MWPOpenComposerUtils","MessagePowerUp","MessagingAttachmentType","OfflineThreadingId","Promise","ReQL","WAHashUtils","asyncToGeneratorRuntime","cr:2472","cr:332","getErrorSafe","promiseDone"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=function(){return o("MAWMpsGating").isMpsMessageRendering()};function d(e,t,n){return{action_url:void 0,attachment_fbid:t,attachment_index:(u||(u=o("I64"))).zero,attachment_type:e.attachmentType,cta1_title:void 0,cta2_title:void 0,cta3_title:void 0,description_text:void 0,filename:e.filename,filesize:void 0,has_media:!0,has_xma:!1,image_url:void 0,mini_preview:void 0,offline_attachment_id:t,original_file_hash:void 0,playable_duration_ms:e.playableDurationMs,playable_url:URL.createObjectURL(n),playable_url_mime_type:n.type,preview_height:void 0,preview_url:void 0,preview_url_mime_type:void 0,preview_width:void 0,source_text:void 0,subtitle_text:void 0,title_text:void 0,waveform_data:e.waveformData,xma_layout_type:void 0,xmas_template_type:void 0}}function m(e,t,n,r){var a;return{action_url:(a=t==null?void 0:t.actionUrl)!=null?a:t==null?void 0:t.nativeUrl,attachment_fbid:n,attachment_index:(u||(u=o("I64"))).zero,attachment_type:e.attachmentType,cta1_title:e.cta1Title,cta2_title:e.cta2Title,cta3_title:e.cta3Title,description_text:e.descriptionText,filename:e.filename,filesize:e.filesize,has_media:!1,has_xma:!0,image_url:void 0,mini_preview:void 0,offline_attachment_id:n,original_file_hash:void 0,playable_duration_ms:void 0,playable_url:r!=null?URL.createObjectURL(r):void 0,playable_url_mime_type:r==null?void 0:r.type,preview_height:void 0,preview_url:r!=null?URL.createObjectURL(r):void 0,preview_url_mime_type:r==null?void 0:r.type,preview_width:void 0,source_text:e.sourceText,subtitle_text:e.subtitleText,title_text:e.titleText,xma_layout_type:e.xmaLayoutType,xmas_template_type:e.xmasTemplateType}}function p(t,a,i,l,s,u,c,d){var m=r("LSFactory")(d);return r("LSOptimisticSendXMAMessageForwardFromSecureThreadStoredProcedure")(m,{attachments:r("LSVec").ofArray([o("LSShape").ofRecord(u)]),isForwarded:s,senderId:t,source:c,text:l!=null?l:void 0,threadKey:a,threadType:i}).then(function(){return(e||(e=n("Promise"))).resolve()})}function _(e,t){if(t!=null)return{amplitudes:t.split(",").map(parseFloat),sampling_freq:e!=null?e:o("MAWAudioUtils").WAVEFORM_SAMPLE_RATE}}function f(t,a,l,c,d,m,p,f,g){var h=r("LSFactory")(f);return r("LSLocalApplyOptimisticMessageWithAttachmentsStoredProcedure")(h,{attachments:r("LSVec").ofArray([o("LSShape").ofRecord(a)]),isForwarded:m,senderId:p,threadKey:d,threadType:c}).then(function(t){var r=t[0],a=t[1];return f.messages_optimistic_context.add({externalAttachmentUrl:void 0,initiatingSource:void 0,markThreadRead:!1,messageId:void 0,offlineThreadingId:r,platformRef:void 0,platformToken:void 0,replySourceId:void 0,replySourceType:void 0,sendType:void 0,skipUrlPreviewGen:void 0,taskId:(u||(u=o("I64"))).of_string(r),threadAttributionSource:g,threadKey:d}).then(function(){return(e||(e=n("Promise"))).resolve(r)})}).then(function(t){var i=a.attachment_fbid;return r("LSInsertNewMediaSendStoredProcedure")(h,{attachmentType:a.attachment_type,inMessageIndex:(u||(u=o("I64"))).zero,isSecure:!1,offlineAttachmentId:i,offlineThreadingId:t,sendByServer:!1,shouldTranscode:!1,useDoublePhase:!1}).then(function(){return(e||(e=n("Promise"))).resolve([t,i])})}).then(function(e){var n=e[0],c=e[1],d=function(a,l){l==null||l.length===0||r("promiseDone")(t.runInTransaction(function(e){var t=r("LSFactory")(e);return r("LSMarkSubJobCompletedV2StoredProcedure")(t,{fbid:(u||(u=o("I64"))).of_string(l),offlineAttachmentId:c}).then(function(){return o("MWPOpenComposerUtils").resumeSendJob(t,n)})},"readwrite",void 0,void 0,i.id+":227"))};return o("MWPComposerMediaUploadUtil").startUpload(void 0,void 0,d,void 0,(u||(u=o("I64"))).equal(a.attachment_type,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").AUDIO)),[l],[c],void 0,void 0,_(a.sampling_frequency_hz,a.waveform_data),void 0,void 0)})}function g(e,t,n,r,o,a,i,l,s){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,l,g,h,y,C,b,v){if(y!=null){var S=y.attachmentType;if(!((u||(u=o("I64"))).equal(S,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").AUDIO))||(u||(u=o("I64"))).equal(S,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE))||(u||(u=o("I64"))).equal(S,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").VIDEO))||(u||(u=o("I64"))).equal(S,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").ANIMATED_IMAGE))||(u||(u=o("I64"))).equal(S,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").FILE))||(u||(u=o("I64"))).equal(S,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").XMA))))throw r("FBLogger")("messenger_web_sharing").mustfixThrow("We do not support forwarding this type");var R=null;if(!(u||(u=o("I64"))).equal(S,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").XMA))&&(isFinite(y.attachmentFbid)?R=yield o("MAWBridgeSendAndReceive").sendAndReceive("backend","getBlobDataUrlByMediaId",{description:"MAWForwardMessageFromSecureThread",mediaId:o("MAWDbMedia").convertNumberToMediaId(Number.parseInt(y.attachmentFbid,10))}):R=yield o("MAWBridgeSendAndReceive").sendAndReceive("backend","getBlobDataUrlByHashedPlaintextHash",{description:"MAWForwardMessageFromSecureThread",plaintextHash:o("WAHashUtils").stringToPlaintextHash(y.attachmentFbid)}).then(function(e){return n("cr:332")!=null&&n("cr:332").runBlobReadAndCompareResult({fileName:y.attachmentFbid,idbBlob:e}),e}),R==null))return;yield t.runInTransaction(function(i){switch(!0){case(u||(u=o("I64"))).equal(S,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").AUDIO)):{var L;if(R==null)throw r("FBLogger")("messenger_web_sharing").mustfixThrow("Blob can not be null for MessagingAttachmentType.AUDIO");var E=new File([R],"mediaForwardedFromSecureThread",{type:R.type}),k=o("OfflineThreadingId").createOfflineThreadingID(),I=o("MWPComposerMediaUploadUtil").getAudioAttachment(k,E,(u||(u=o("I64"))).to_int32((L=y.playableDurationMs)!=null?L:(u||(u=o("I64"))).zero)/1e3,_(y.samplingFrequencyHz!=null?(u||(u=o("I64"))).to_int32(y.samplingFrequencyHz):void 0,y.waveformData));return f(t,I,E,l,a,h,C,i,b)}case(u||(u=o("I64"))).equal(S,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").XMA)):{var T;return o("ReQL").firstAsync(o("ReQL").fromTableDescending(i.attachment_ctas).getKeyRange((T=y.defaultCtaId)!=null?T:(u||(u=o("I64"))).zero)).then(function(t){var a,i=y.xmaPreviewFbid;if(i==null)return r("FBLogger")("messenger_web_sharing").mustfix("XMA preview fbid is null when forwarding XMA"),(e||(e=n("Promise"))).resolve([t,void 0]);if(c())a=o("MAWBridgeSendAndReceive").sendAndReceive("backend","getBlobDataUrlByHashedPlaintextHash",{description:"MAWForwardMessageFromSecureThread",plaintextHash:o("WAHashUtils").stringToPlaintextHash(i)}).then(function(e){return n("cr:332")!=null&&n("cr:332").runBlobReadAndCompareResult({fileName:y.attachmentFbid,idbBlob:e}),e});else try{a=o("MAWBridgeSendAndReceive").sendAndReceive("backend","getBlobDataUrlByMediaId",{description:"MAWForwardMessageFromSecureThread",mediaId:o("MAWDbMedia").convertNumberToMediaId(Number.parseInt(i,10))})}catch(o){var l=r("getErrorSafe")(o);return r("FBLogger")("messenger_web_sharing").mustfix("XMA preview fbid is not a valid mediaId when forwarding XMA %s",l.message),(e||(e=n("Promise"))).resolve([t,void 0])}return a.then(function(r){return(e||(e=n("Promise"))).resolve([t,r])}).catch(function(o){return r("FBLogger")("messenger_web_sharing").catching(o).warn("Unable to getBlobDataUrlByXMAId, from MAWForwardMessageFromSecureThread"),(e||(e=n("Promise"))).resolve([t,void 0])})}).then(function(e){var t=e[0],r=e[1],s=null;r!=null&&(s=new File([r],"xmaForwardedFromSecureThread",{type:r.type}));var u=o("OfflineThreadingId").createOfflineThreadingID(),c=m(y,t,u,s),d=g.text,_=n("cr:2472")==null||d==null?d:n("cr:2472").unvault(d);return p(C,a,l,v!=null?v:_,h,c,b,i)})}case(u||(u=o("I64"))).equal(S,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").FILE)):case(u||(u=o("I64"))).equal(S,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE)):case(u||(u=o("I64"))).equal(S,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").VIDEO)):case(u||(u=o("I64"))).equal(S,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").ANIMATED_IMAGE)):{var D;if(R==null)throw r("FBLogger")("messenger_web_sharing").mustfixThrow("Blob can not be null for MessagingAttachmentType.AUDIO");var x=new File([R],(D=y.filename)!=null?D:"mediaForwardedFromSecureThread",{type:R.type}),$=o("OfflineThreadingId").createOfflineThreadingID(),P=d(y,$,x);return f(t,P,x,l,a,h,C,i,b)}default:throw r("FBLogger")("messenger_web_sharing").mustfixThrow("We do not support forwarding this type")}},"readwrite",void 0,void 0,i.id+":342")}else{var L=g.text;if(L==null)throw r("FBLogger")("messenger_web_sharing").mustfixThrow("We do not support forwarding this type");var E=n("cr:2472")==null?L:n("cr:2472").unvault(L),k=E==="\uD83D\uDC4D"&&g.hotEmojiSize!=null&&(u||(u=o("I64"))).equal(g.hotEmojiSize,(s||(s=o("LSIntEnum"))).ofNumber(r("LSHotEmojiSize").SMALL)),I=k?(u||(u=o("I64"))).of_string("369239263222822"):void 0;yield t.runInTransaction(function(e){return r("LSOptimisticSendMessageV2StoredProcedure")(r("LSFactory")(e),{extraSendMessageParams:o("LSShape").ofRecord({calculate_denormalizations:!1,is_forwarded:h,mark_read:!1,power_up_style:(s||(s=o("LSIntEnum"))).ofNumber(r("MessagePowerUp").NONE),source:b,sticker_id:I}),mailboxType:s.ofNumber(r("LSMailboxType").MESSENGER),senderId:C,text:k?void 0:v!=null?v:E,threadKey:a,threadType:l})},"readwrite",void 0,void 0,i.id+":553")}}),h.apply(this,arguments)}l.getMediaAttachment=d,l.uploadAndSendMediaToOpenThread=f,l.forwardMessage=g}),98);
__d("VideoFrameBuffer",["HTMLMediaElementReadyStates","getErrorSafe"],(function(t,n,r,o,a,i,l){var e=(function(){function e(e,t,n,r,o,a,i){r===void 0&&(r=null),o===void 0&&(o=null),a===void 0&&(a=null),i===void 0&&(i=null),this.$2=t,this.$1=e,this.$3=n||"contain",this.$6=r,this.$7=o,this.$8=a,this.$9=i}var t=e.prototype;return t.updateFrameBuffer=function(){if(this.$4&&(this.$1.width=this.$4,this.$4=null),this.$5&&(this.$1.height=this.$5,this.$5=null),!(this.$2.readyState<r("HTMLMediaElementReadyStates").HAVE_CURRENT_DATA)){var e=this.$1.clientWidth||this.$1.width,t=this.$1.clientHeight||this.$1.height,n=e,o=t,a=this.$2.videoWidth/this.$2.videoHeight,i=n/o;this.$3==="cover"&&(i*=-1,a*=-1),i>a?n=o*a:i<a&&(o=n/a);var l=this.$1.getContext("2d");if(l instanceof window.CanvasRenderingContext2D)try{if(this.$6||this.$7){var s,u,c,d;l.drawImage(this.$2,(s=this.$8)!=null?s:0,(u=this.$9)!=null?u:0,(c=this.$6)!=null?c:e,(d=this.$7)!=null?d:t,0,0,e,t)}else l.drawImage(this.$2,(e-n)/2,(t-o)/2,n,o)}catch(e){var m=r("getErrorSafe")(e);if(m.name!=="NS_ERROR_NOT_AVAILABLE")throw m}}},t.getDOMNode=function(){return this.$1},t.updateDimensions=function(t,n){this.$4=t,this.$5=n},e})();l.default=e}),98);
__d("generateVideoThumbnails",["CPXComposerConstants","CanvasVideoThumbnail","HTMLMediaElementReadyStates","Promise","VideoFrameBuffer","cr:909281"],(function(t,n,r,o,a,i,l){var e,s=.5625;function u(t,o,a,i,l,s,u,f,g,h){return l===void 0&&(l="contain"),s===void 0&&(s=0),u===void 0&&(u=null),f===void 0&&(f=null),g===void 0&&(g=null),h===void 0&&(h=null),new(e||(e=n("Promise")))(function(e,y){var C=document.createElement("canvas"),b=[],v=0,S=t.duration-s;h!=null&&(S=Math.min(S,h));var R=S/i,L=null,E=null,k,I=f!=null?f:c(u,o),T=g!=null?g:d(u,a),D=m(u,o),x=p(u,a);C.width=I!=null?I:o,C.height=T!=null?T:a;var $=new(r("VideoFrameBuffer"))(C,t,l,I,T,D,x);$.updateFrameBuffer();var P=function(){$.updateFrameBuffer();var e=new(r("CanvasVideoThumbnail"))(C,t,s+(v-1)*R,I,T,D,x);b.push(e),(!L||e.getURL().length>L.getURL().length)&&(L=e,E=_(u,t)),M()},N=function(){if(t.readyState>=r("HTMLMediaElementReadyStates").HAVE_CURRENT_DATA)P();else if(n("cr:909281")!==null)var e=n("cr:909281").listen(t,"loadeddata",function(){e.remove(),P()});else t.addEventListener("loadeddata",P,{once:!0})},M=function(){v===0&&(n("cr:909281")!==null?k=n("cr:909281").listen(t,"seeked",N):t.addEventListener("seeked",N)),v<i?(t.currentTime=s+v*R,v++):(n("cr:909281")!==null?k&&k.remove():t.removeEventListener("seeked",N),e({thumbnails:b,selectedThumbnail:L,croppedThumbnailUri:E}))};if(t.videoWidth===0||t.videoHeight===0){y();return}M()})}function c(e,t){if(e&&e.spherical){if(e.stereoMode==="left-right")return t/2;if(e.projectionType==="cubemap")return t/3}return null}function d(e,t){return e&&e.spherical&&(e.stereoMode==="top-bottom"||e.projectionType==="cubemap")?t/2:null}function m(e,t){return e&&e.spherical&&e.projectionType==="cubemap"?t/3:0}function p(e,t){return e&&e.spherical&&e.projectionType==="cubemap"?t/2:0}function _(e,t){var n=t.videoWidth!=null&&t.videoHeight!=null?t.videoWidth/t.videoHeight:s,r=n<1;if(e==null&&!r){var a=document.createElement("canvas"),i=a.getContext("2d"),l=t.videoWidth,u=t.videoHeight;a.width=l,a.height=u,i.drawImage(t,0,0,l,u);var c=document.createElement("canvas"),d,m;n>=1&&n<1.2?(d=l*(o("CPXComposerConstants").REEL_THUMBNAIL_WIDTH/o("CPXComposerConstants").REEL_THUMBNAIL_HEIGHT),m=u):(d=u,m=l),c.width=d,c.height=m;var p=c.getContext("2d");return p.drawImage(a,0,0,l,u,0,0,d,m),c.toDataURL("image/jpeg")}return null}l.default=u}),98);
__d("MAWVideoUtils",["FBLogger","MAWImageUtils","Promise","generateVideoThumbnails"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){var a=document.body;if(!a)return new(e||(e=n("Promise")))(function(e,t){return t("Unable to find DOM body, please use this util only in DOM environment.")});var i=document.createElement("video");return new(e||(e=n("Promise")))(function(o,l){i.setAttribute("style","display: none"),i.setAttribute("src",URL.createObjectURL(t)),i.addEventListener("loadedmetadata",function(t){var a=t.currentTarget;if(a instanceof HTMLVideoElement){var s=a.duration,u=a.videoHeight,c=a.videoWidth,d=r("generateVideoThumbnails")(i,c,u,1);o((e||(e=n("Promise"))).all([d,c,u,Math.round(s)]))}else l("EventTarget returned for event should be HTMLVideoElement")}),i.addEventListener("error",function(e){l("Unable to load video")}),a.appendChild(i)}).then(function(e){var t=e[0],n=e[1],r=e[2],l=e[3];return a.removeChild(i),o("MAWImageUtils").canvasToBlob(t.thumbnails[0].getCanvas(),o("MAWImageUtils").TYPE_JPEG,!0).then(function(e){return e.arrayBuffer().then(function(e){return{duration:l,height:r,jpegThumbnail:e,width:n}})})}).catch(function(e){throw a.removeChild(i),r("FBLogger")("messenger_web").mustfixThrow(e)})}function u(t){var o=document.body;if(!o)return new(e||(e=n("Promise")))(function(e,t){return t("Unable to find DOM body, please use this util only in DOM environment.")});var a=document.createElement("video");return new(e||(e=n("Promise")))(function(e,n){a.setAttribute("style","display: none"),a.setAttribute("src",URL.createObjectURL(t)),a.addEventListener("loadedmetadata",function(t){var r=t.currentTarget;if(r instanceof HTMLVideoElement){var o=r.duration,a=r.videoHeight,i=r.videoWidth;e({duration:Math.round(o),height:a,width:i})}else n("EventTarget returned for event should be HTMLVideoElement")}),a.addEventListener("error",function(e){n("Unable to load video")}),o.appendChild(a)}).catch(function(e){throw o.removeChild(a),r("FBLogger")("messenger_web").mustfixThrow(e)})}l.getVideoThumbnailUrlAndSpec=s,l.getVideoThumbnailSpec=u}),98);
__d("MAWFowardMessageFromOpenThread",["FBLogger","I64","LSIntEnum","MAWAudioUtils","MAWBridgeSendAndReceive","MAWDocumentPreProcess","MAWFetchXMABlob","MAWFetchXMAData","MAWFetchXMADataUtils","MAWForwardMessage","MAWGetEphemeralSettings","MAWGetImageSpec","MAWImagePreProcess","MAWMessageSendReporter","MAWUnshimUrl","MAWVault","MAWVideoUtils","MessagingAttachmentType","Promise","ReQL","WAArmadilloXMA.pb","WABlobToArrayBuffer","asyncToGeneratorRuntime","gkx","qpl","sendToSentQPLLogger"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c="369239263222822",d="369239343222814",m="369239383222810";function p(e){return e===c||e===d||e===m}function _(e,t){return(u||(u=n("Promise"))).all([o("MAWGetImageSpec").getImageSpec_DEPRECATED(e),u.resolve(e),t.arrayBuffer(),o("MAWGetImageSpec").getImageSpec_DEPRECATED(t)]).then((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e[0],n=e[1],r=e[2],a=e[3];return{file:n,imageSpec:t,plaintext:yield o("WABlobToArrayBuffer").blobToArrayBuffer(n),thumbnailUrlAndSpec:{duration:void 0,height:a.height,jpegThumbnail:r,width:a.width},type:"image"}});return function(t){return e.apply(this,arguments)}})())}function f(e){return o("MAWVideoUtils").getVideoThumbnailUrlAndSpec(e).then((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){return{file:e,plaintext:yield o("WABlobToArrayBuffer").blobToArrayBuffer(e),thumbnailUrlAndSpec:t,type:"video"}});return function(e){return t.apply(this,arguments)}})())}function g(e,t){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("MAWFetchXMABlob").fetchBlob({descriptionForLogging:"MAWFowardMessageFromOpenThread",url:e}),r=n==null?void 0:new File([n],t,{type:n.type}),a=r!=null?yield o("MAWGetImageSpec").getImageSpec_DEPRECATED(r):null;return r!=null&&a!=null?{file:r,height:a.height,width:a.width}:void 0}),h.apply(this,arguments)}function y(e,t,n){return C.apply(this,arguments)}function C(){return C=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r,a,i=yield o("ReQL").firstAsync(o("ReQL").fromTableAscending(n.tables.attachment_ctas).getKeyRange(e));return i==null||t==null&&i.actionUrl==null?null:{actionUrl:(r=i==null?void 0:i.actionUrl)!=null?r:void 0,buttonType:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:(a=i==null?void 0:i.actionUrl)!=null?a:void 0,title:t!=null?t:void 0}}),C.apply(this,arguments)}function b(e,t,n,r){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,a){var i=yield S(t,n);if((i==null?void 0:i.actionUrl)==null)throw o("sendToSentQPLLogger").markSendToSentFail(a,"null_xma_url"),r("FBLogger")("messenger_web_sharing").mustfixThrow("Cannot forward XMA to secure threads without a defaultCTA and actionUrl");var l=yield o("MAWFetchXMAData").fetchXMAData(e,i.actionUrl,[a]);if(l.linkType==="unknown")throw o("sendToSentQPLLogger").markSendToSentFail(a,"unknown_xma_link_type"),r("FBLogger")("messenger_web_sharing").mustfixThrow("Cannot forward XMA to secure threads with an unknown link type");return l.linkType==="external"?k(t,i,n,l):L(l,a)}),v.apply(this,arguments)}function S(e,t){return R.apply(this,arguments)}function R(){return R=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=e.actionUrl,r=e.defaultCtaId,a=e.defaultCtaTitle;if(r==null)return null;var i=yield y(r,a,t);return i!=null?i:{actionUrl:n!=null?n:void 0,buttonType:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_CTA_BUTTON_TYPE.OPEN_NATIVE,nativeUrl:n!=null?n:void 0,title:a!=null?a:void 0}}),R.apply(this,arguments)}function L(e,t){return E.apply(this,arguments)}function E(){return E=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("MAWFetchXMADataUtils").makeXMAFileArgs(e,t),r=e.contentRef,a=e.ctas,i=e.defaultCTA,l=e.overlayIconGlyph,s=e.subtitle_text,u=e.title_text,c=e.xma_message_type,d={contentRef:r,ctas:a,defaultCTA:i,overlayIconGlyph:l,subtitleText:s,titleText:u};return babelHelpers.extends({},n,{xmaArgs:d,xmaMessageType:c!=null?c:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE})}),E.apply(this,arguments)}function k(e,t,n,r){return I.apply(this,arguments)}function I(){return I=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r,a,i){var l=t.attachmentCta1Id,s=t.attachmentCta2Id,c=t.attachmentCta3Id,d=t.cta1Title,m=t.cta2Title,p=t.cta3Title,_=t.faviconUrl,f=t.headerImageUrl,h=t.headerTitle,C=t.maxSubtitleNumOfLines,b=t.maxTitleNumOfLines,v=t.previewUrl,S=t.subtitleText,R=t.titleText,L=yield(u||(u=n("Promise"))).all([[_,"favicon"],[f,"headerImage"],[v,"preview"]].map(function(e){return g(e[0],e[1])})),E=L[0],k=L[1],I=L[2],T=[];if(l!=null){var D=yield y(l,d,a);D!=null&&T.push(D)}if(s!=null){var x=yield y(s,m,a);x!=null&&T.push(x)}if(c!=null){var $=yield y(c,p,a);$!=null&&T.push($)}var P={contentRef:i.contentRef,ctas:T.map(function(e){return babelHelpers.extends({},e,{actionUrl:o("MAWUnshimUrl").unshimUrl(e.actionUrl),nativeUrl:o("MAWUnshimUrl").unshimUrl(e.nativeUrl)})}),defaultCTA:babelHelpers.extends({},r,{actionUrl:o("MAWUnshimUrl").unshimUrl(r.actionUrl),nativeUrl:o("MAWUnshimUrl").unshimUrl(r.nativeUrl)}),headerTitle:h,maxSubtitleNumOfLines:(e||(e=o("I64"))).to_int32(C!=null?C:(e||(e=o("I64"))).zero),maxTitleNumOfLines:e.to_int32(b!=null?b:(e||(e=o("I64"))).zero),overlayIconGlyph:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_OVERLAY_ICON_GLYPH.NONE,subtitleText:S,titleText:R};return{faviconFileArgs:E,headerFileArgs:k,previewFileArgs:I,xmaArgs:P,xmaMessageType:i.xma_message_type}}),I.apply(this,arguments)}function T(t){var a=t.attachmentType,i=t.filename,l=t.playableDurationMs,c=t.playableUrl,d=t.playableUrlMimeType,m=t.previewUrl,p=t.previewUrlMimeType;if((e||(e=o("I64"))).equal(a,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE))||(e||(e=o("I64"))).equal(a,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").VIDEO))||(e||(e=o("I64"))).equal(a,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").ANIMATED_IMAGE))||(e||(e=o("I64"))).equal(a,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").FILE))){if(c==null)throw r("FBLogger")("messenger_web_sharing").mustfixThrow("If you see this error, there is no playableUrl for this attachment");var g=(e||(e=o("I64"))).equal(a,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").ANIMATED_IMAGE));if(m!=null){var h=g?m+"&":c,y=g?m+"&":m;return(u||(u=n("Promise"))).all([window.fetch(h).then(function(e){return e.blob()}),window.fetch(y).then(function(e){return e.blob()})]).then(function(t){var n=t[0],i=t[1],l=new File([n],"mediaForwardedFromOpenThread",{type:g?p:d}),u=new File([i],"previewForwardedFromOpenThread",{type:p});if((e||(e=o("I64"))).equal(a,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE)))return _(l,u);if((e||(e=o("I64"))).equal(a,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").VIDEO)))return f(l);if((e||(e=o("I64"))).equal(a,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").ANIMATED_IMAGE)))return _(l,u);throw r("FBLogger")("messenger_web_sharing").mustfixThrow("shouldn't have this error in forward message from open thread")})}var C=g?c+"&":c;return window.fetch(C).then(function(e){return e.blob()}).then(function(t){if(g&&d==="video/mp4")throw r("FBLogger")("messenger_web_sharing").mustfixThrow("If you see this error, there is only mp4 url for gif");var l=new File([t],i!=null?i:"mediaForwardedFromOpenThread",{type:d});if((e||(e=o("I64"))).equal(a,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").IMAGE)))return o("MAWImagePreProcess").imagePreprocess(l,!1);if((e||(e=o("I64"))).equal(a,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").VIDEO)))return f(l);if((e||(e=o("I64"))).equal(a,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").FILE)))return o("MAWDocumentPreProcess").documentPreprocess(l);if((e||(e=o("I64"))).equal(a,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").ANIMATED_IMAGE)))return(u||(u=n("Promise"))).all([o("MAWImagePreProcess").getJpegThumbnailInfo(l,400),o("MAWGetImageSpec").getImageSpec_DEPRECATED(l),u.resolve(l)]).then((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e[0],n=e[1],r=e[2];return{file:r,imageSpec:n,plaintext:yield o("WABlobToArrayBuffer").blobToArrayBuffer(r),thumbnailUrlAndSpec:t,type:"image"}});return function(t){return e.apply(this,arguments)}})());throw r("FBLogger")("messenger_web_sharing").mustfixThrow("shouldn't have this error in forward message from open thread")})}if((e||(e=o("I64"))).equal(a,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").AUDIO))){if(c!=null)return window.fetch(c+"&").then(function(e){return e.blob()}).then((function(){var a=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){var a=new File([n],"mediaForwardedFromOpenThread",{type:d}),i,s=t.waveformData;if(s!=null&&s!==""&&r("gkx")("20216")){var u=s.split(",").map(Number);if(u.every(function(e){return!Number.isNaN(e)})){var c=o("MAWAudioUtils").recomputeWaveform(u);i=new Uint8Array(c).buffer}else r("FBLogger")("messenger_web_sharing").warn("Waveform data is invalid. Forwarding skipped.")}return{durations:(e||(e=o("I64"))).to_int32(l!=null?l:(e||(e=o("I64"))).zero)/1e3,file:a,isPtt:!0,plaintext:yield o("WABlobToArrayBuffer").blobToArrayBuffer(a),type:"audio",waveform:i}});return function(e){return a.apply(this,arguments)}})());throw r("FBLogger")("messenger_web_sharing").mustfixThrow("If you see this error, there is no playableUrl for this audio attachment")}if((e||(e=o("I64"))).equal(a,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").STICKER))){if(c==null&&m==null)throw r("FBLogger")("messenger_web_sharing").mustfixThrow("If you see this error, there is no url for this sticker");return c!=null?m!=null?(u||(u=n("Promise"))).all([window.fetch(c).then(function(e){return e.blob()}),window.fetch(m).then(function(e){return e.blob()})]).then(function(e){var t=e[0],n=e[1],r=new File([t],"mediaForwardedFromOpenThread",{type:d}),o=new File([n],"previewForwardedFromOpenThread",{type:p});return _(r,o)}):window.fetch(c).then(function(e){return e.blob()}).then(function(e){var t=new File([e],"mediaForwardedFromOpenThread",{type:d});return _(t,t)}):window.fetch(m).then(function(e){return e.blob()}).then(function(e){return o("MAWImagePreProcess").imagePreprocess(new File([e],"previewForwardedFromOpenThread",{type:p}),!0)})}throw r("FBLogger")("messenger_web_sharing").mustfixThrow("We do not support forwarding other media types. Received attachment %d",(s||(s=o("LSIntEnum"))).toNumber(a))}function D(t,a,i,l,u,c,d,m,_){return o("MAWForwardMessage").maybeCreateNewThreadAndCallback(a,i,function(f,g){var h=o("MAWGetEphemeralSettings").getEphemeralSetting(f,i),y=g;return h.then(function(i){if(c!=null){if(p(c.attachmentFbid)){var g=o("MAWBridgeSendAndReceive").sendAndReceive("backend","sendMsg",{args:{content:"\uD83D\uDC4D",ephemeralSetting:i!=null?i:void 0,isFirstMsg:y,isForwarded:u,source:d,specialTextSize:1},chatJid:f,externalId:_,qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:m});return o("MAWMessageSendReporter").MAWMessageSendReporter({chatJid:f,externalId:_},g,{qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:m},a)}return(e||(e=o("I64"))).equal(c.attachmentType,(s||(s=o("LSIntEnum"))).ofNumber(r("MessagingAttachmentType").XMA))?b(t,c,a,m).then(function(e){var t=e.faviconFileArgs,n=e.headerFileArgs,s=e.previewFileArgs,u=e.xmaArgs,c=e.xmaMessageType,d=l.text,p=o("MAWBridgeSendAndReceive").sendAndReceive("backend","sendXMAShareMsg",{args:{content:d!=null&&o("MAWVault").isVaulted(d)?o("MAWVault").unvault(d):d,ephemeralSetting:i!=null?i:void 0,isFirstMsg:y,isForwarded:!0,xmaMessageType:c!=null?c:o("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE},chatJid:f,faviconFile:t,headerFile:n,previewFile:s,qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:m,xmaArgs:u,xmaMsgExternalId:_});return o("MAWMessageSendReporter").MAWMessageSendReporter({chatJid:f,externalId:_},p,{qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:m},a)}):T(c).then((function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t,n;switch(e.type){case"image":{var l=e.imageSpec,s=e.thumbnailUrlAndSpec;n={args:{ephemeralSetting:i!=null?i:void 0,height:l.height,isFirstMsg:y,isForwarded:u,jpegThumbnail:s==null?void 0:s.jpegThumbnail,jpegThumbnailHeight:s==null?void 0:s.height,jpegThumbnailWidth:s==null?void 0:s.width,source:d,width:l.width},attachmentType:"image",chatJid:f,externalId:_};break}case"video":{var c=e.thumbnailUrlAndSpec;n={args:{duration:c.duration,ephemeralSetting:i!=null?i:void 0,height:c.height,isFirstMsg:y,isForwarded:u,jpegThumbnail:c.jpegThumbnail,jpegThumbnailHeight:c.height,jpegThumbnailWidth:c.width,source:d,width:c.width},attachmentType:"video",chatJid:f,externalId:_};break}case"audio":{var p=e.durations,g=e.isPtt,h=e.waveform;n={args:{duration:Math.round(p),ephemeralSetting:i!=null?i:void 0,isFirstMsg:y,isForwarded:u,isPtt:g,source:d,waveform:h},attachmentType:"audio",chatJid:f,externalId:_};break}case"document":{n={args:{ephemeralSetting:i!=null?i:void 0,filename:e.filename,isFirstMsg:y,isForwarded:u,source:d},attachmentType:"application",chatJid:f,externalId:_};break}}if(n==null)throw r("FBLogger")("messenger_web_sharing").mustfixThrow("We do not support forwarding this attachment type: %s",e.type);var C=o("MAWBridgeSendAndReceive").sendAndReceive("backend","sendMediaMsgV2",babelHelpers.extends({},n,{mimeType:e.file.type,plaintext:(t=e.plaintext)!=null?t:yield o("WABlobToArrayBuffer").blobToArrayBuffer(e.file),qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:m}));return o("MAWMessageSendReporter").MAWMessageSendReporter({chatJid:f,externalId:_},C,{qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:m},a)});return function(t){return e.apply(this,arguments)}})())}var h=l.text;if(h!=null){var C=o("MAWBridgeSendAndReceive").sendAndReceive("backend","sendMsg",{args:{content:o("MAWVault").isVaulted(h)?o("MAWVault").unvault(h):h,ephemeralSetting:i!=null?i:void 0,isFirstMsg:y,isForwarded:u,source:d},chatJid:f,externalId:_,qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:m});return o("MAWMessageSendReporter").MAWMessageSendReporter({chatJid:f,externalId:_},C,{qplEventType:r("qpl")._(25313175,"1551"),qplInstanceKey:m},a)}throw r("FBLogger")("messenger_web_sharing").mustfixThrow("We do not support forwarding this types")})},m)}l.downloadMediaByUrl=T,l.forwardMessage=D}),98);
__d("forwardAttachmentFromInstamadilloToOpen",["I64","LSIntEnum","MAWForwardMessageFromSecureThread.react","OfflineThreadingId","asyncToGeneratorRuntime","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=r("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("forwardAttachmentFromInstamadilloToOpen");function c(e,t,n,r,o,a){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,r,a,i,l){var c=yield u.load(),d=yield c(),m=o("OfflineThreadingId").createOfflineThreadingID(),p={attachment_fbid:m,attachment_index:(e||(e=o("I64"))).zero,attachment_type:t.attachmentType,filename:t.filename,has_media:!0,has_xma:!1,offline_attachment_id:m,playable_duration_ms:t.playableDurationMs,playable_url:URL.createObjectURL(n),playable_url_mime_type:n.type,preview_height:t.previewHeight,preview_url:URL.createObjectURL(n),preview_width:t.previewWidth};yield d.runInTransaction(function(t){return o("MAWForwardMessageFromSecureThread.react").uploadAndSendMediaToOpenThread(d,p,n,(s||(s=o("LSIntEnum"))).ofNumber(a),(e||(e=o("I64"))).of_string(r),!0,i,t,l)},"readwrite")}),d.apply(this,arguments)}l.default=c}),98);
__d("forwardAttachmentToInstamadillo",["I64","IGDBridgedAPI","LSFactory","LSIntEnum","LSLocalApplyOptimisticMessageWithAttachmentsV2StoredProcedure","LSPendingTasksPluginType","LSShape","LSVec","OfflineThreadingId","asyncToGeneratorRuntime","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=r("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("forwardAttachmentToInstamadillo");function c(e,t,n,r,o,a,i){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i,l,c,d,m){var p=yield u.load(),_=yield p(),f=o("OfflineThreadingId").createOfflineThreadingID(),g={attachment_fbid:f,attachment_index:(e||(e=o("I64"))).zero,attachment_type:t.attachmentType,filename:t.filename,has_media:!0,has_xma:!1,offline_attachment_id:f,playable_duration_ms:t.playableDurationMs,playable_url:URL.createObjectURL(a),playable_url_mime_type:a.type,preview_height:t.previewHeight,preview_url:URL.createObjectURL(a),preview_width:t.previewWidth},h=yield _.runInTransaction((function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=yield r("LSLocalApplyOptimisticMessageWithAttachmentsV2StoredProcedure")(r("LSFactory")(t),{extraSendMessageParams:o("LSShape").ofRecord({attachments:r("LSVec").ofArray([o("LSShape").ofRecord(g)]),is_forwarded:!0,mark_read:!1,plugin_type:(s||(s=o("LSIntEnum"))).ofNumber(r("LSPendingTasksPluginType").IGD_INSTAMADILLO),source:d}),senderId:c,threadKey:(e||(e=o("I64"))).of_string(i),threadType:s.ofNumber(l)}),a=n[0];return yield t.messages_optimistic_context.add({markThreadRead:!1,offlineThreadingId:a,openEb:m,taskId:e.of_string(a),threadAttributionSource:d,threadKey:e.of_string(i)}),a});return function(e){return t.apply(this,arguments)}})(),"readwrite");return yield r("IGDBridgedAPI").sendMediaMessage({offlineThreadingId:h}),h}),d.apply(this,arguments)}l.default=c}),98);
__d("forwardAttachmentToOpen",["I64","LSFactory","LSIntEnum","LSOptimisticSendAttachmentForwardStoredProcedure","asyncToGeneratorRuntime","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=r("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("forwardAttachmentToOpen");function c(e,t,n,r,o){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n,a,i,l){var c=yield u.load(),d=yield c(),m=yield d.runInTransaction(function(u){return r("LSOptimisticSendAttachmentForwardStoredProcedure")(r("LSFactory")(u),{forwardedAttachmentFbid:(e||(e=o("I64"))).of_string(t),senderId:i,source:l,threadKey:e.of_string(n),threadType:(s||(s=o("LSIntEnum"))).ofNumber(a)})},"readwrite"),p=m[0];return p}),d.apply(this,arguments)}l.default=c}),98);
__d("forwardAttachment",["FBLogger","I64","MAWDbMedia","MAWFowardMessageFromOpenThread","Promise","asyncToGeneratorRuntime","forwardAttachmentFromInstamadilloToOpen","forwardAttachmentToInstamadillo","forwardAttachmentToOpen","requireDeferred"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=r("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("forwardAttachment");function c(e,t,n,r,o,a){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,a,i,l,c,d){var m=yield u.load(),p=yield m(),_=yield p.tables.e2ee_media.get(o("MAWDbMedia").convertToMediaId64((s||(s=o("I64"))).of_float(Number.parseInt(t.attachmentFbid,10)))),f,g=!1;if(_!=null){var h=yield p.tables.e2ee_chunk.index("hashedPlaintextHash").get(_.hashedPlaintextHash);if(h!=null){var y=new Blob([h.blobData],{type:h.mimetype});f=new File([y],"IGDForwardFromSecureThread-"+t.attachmentFbid,{type:y.type}),g=!0}else return r("FBLogger")("igd_web").mustfix("Missing chunk for e2ee media when forwarding an E2EE media message"),(e||(e=n("Promise"))).resolve()}else{var C=yield o("MAWFowardMessageFromOpenThread").downloadMediaByUrl(t);f=C.file}return d!=null&&d.useInstamadilloTransport?r("forwardAttachmentToInstamadillo")(t,f,a,i,l,c,!!(d!=null&&d.useOpenEb)):g?r("forwardAttachmentFromInstamadilloToOpen")(t,f,a,i,l,c):r("forwardAttachmentToOpen")(t.attachmentFbid,a,i,l,c)}),d.apply(this,arguments)}l.default=c}),98);
__d("useGetForwardSource",["LSIntEnum","LSMessagingThreadAttributionType","MWLSThreadDisplayContext"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){var t=o("MWLSThreadDisplayContext").useMWLSThreadDisplayContext();return t!=null?t==="Inbox"?(e||(e=o("LSIntEnum"))).ofNumber(r("LSMessagingThreadAttributionType").MESSENGER_INBOX_FORWARD):t==="ChatTab"?(e||(e=o("LSIntEnum"))).ofNumber(r("LSMessagingThreadAttributionType").MESSENGER_CHAT_FORWARD):(e||(e=o("LSIntEnum"))).ofNumber(r("LSMessagingThreadAttributionType").MESSENGER_BROADCAST_FLOW):(e||(e=o("LSIntEnum"))).ofNumber(r("LSMessagingThreadAttributionType").MESSENGER_BROADCAST_FLOW)}l.default=s}),98);
